## **F. 最佳訊號路徑** ***<font color = '#AAAAAA'> Optimal Signal Path </font>***

`time limit` 2s
`memory limit` 256MB

### ***Statement***
身為一個現代人，**MelonWalker** 深知「訊號就是生命」的道理！偏偏他使用的電信公司訊號很不給力，所以他出門在外，總是要想辦法走在基地台附近。然而，**MelonWalker** 是個十足的路痴，出門完全依賴 $\texttt{Google Maps}$。糟糕的是，它居然沒有「最佳訊號路徑」這種高科技功能，所以你的任務就是替他找到一條路徑，讓他在整段旅程中，距離基地台最遠的那個點離基地台的距離，是所有路徑裡面最短的，這才能讓他安心地滑手機。

現在給你一張包含 $N$ 個點、$M$ 條邊的無向帶權圖，點的編號從 $1$ 到 $N$。每條邊由 $u, v, w$ 表示，代表點 $u$ 和點 $v$ 之間的距離是 $w$。

並且已知 $K$ 個**基地台**的位置 $x_1, x_2, \ldots, x_K$。

接下來，**MelonWalker** 會問你 $Q$ 個問題，每個問題會給定他現在的起點 $s$ 和目的地 $t$。你需要幫他找出從 $s$ 到 $t$ 的最佳訊號路徑，並輸出這條路徑上離基地台最遠的點與基地台的距離。最佳訊號路徑代表這條路徑上的所有點，它們距離最近的基地台的距離中的最大值是所有可能路徑中最小的。

![Image](https://hackmd.io/_uploads/rkyBtG-wee.jpg)

<div class = 'page' />

### ***Input***
$N\ M$
$u_1\ v_1\ w_1$
$u_2\ v_2\ w_2$
$\vdots$
$u_M\ v_M\ w_M$
$K$
$x_1\ x_2\ \ldots\ x_K$
$Q$
$s_1\ t_1$
$s_2\ t_2$
$\vdots$
$s_Q\ t_Q$

輸入的第一行包含兩個整數 $N$ 和 $M$，分別代表圖中的總節點數和邊數。
接下來的 $M$ 行，每行包含三個整數 $u, v, w$，表示點 $u$ 和 $v$ 的距離為 $w$。
再接下來的一行包含一個整數 $K$，代表基地台的數量。
再接下來的一行包含 $K$ 個整數 $x_1, x_2, \ldots, x_K$，表示 $K$ 個基地台的節點編號。
最後一行包含一個整數 $Q$，代表詢問的總筆數。
接下來的 $Q$ 行，每行包含兩個整數 $s, t$，表示一筆詢問的起點和終點。

### ***Output***
$Ans_1$
$Ans_2$
$\vdots$
$Ans_Q$

$Ans_k$ 代表第 $k$ 筆詢問的答案

<div class = 'page' />


### ***Sample Input***
```
6 8
1 3 3
1 5 5
1 6 1
2 5 2
2 6 4
3 4 3
3 5 1
5 6 1
2
3 5
4
1 2
4 2
5 5
2 3
```

### ***Sample Output***
```
2
3
0
2
```
對於第一筆詢問，從 $1$ 到 $2$ 的路徑，考慮 $1 \to 3 \to 5 \to 2$：
-   點 $1$ 距離最近基地台的距離是 $2$ (到基地台 $5$)。
-   點 $3$ 本身就是基地台，距離為 $0$。
-   點 $5$ 本身就是基地台，距離為 $0$。
-   點 $2$ 距離最近基地台的距離是 $2$ (到基地台 $5$)。
這條路徑上的點 $(1, 3, 5, 2)$ 距離最近基地台的距離分別是 $(2, 0, 0, 2)$。
這些距離中的最大值是 $2$。經證明，沒有其他路徑能得到更小的最大距離。

<div class = 'page' />

### ***Note***
* $1 \leq N, Q \leq 2\times10^5$
* $N - 1 \leq M \leq \min(\frac{N \times (N-1)}{2}, 2\times 10^5)$
* $1 \leq K, x, u, v, s, t \leq N$
* $1 \leq w \leq 10^9$
* 任兩點至少有一條路徑可到達
* 保證圖無自環和重邊
* 所有輸入輸出皆為整數


### ***Subtask***
- ***subtask1***: $6\\%$ $K = 1 \texttt{ and } \forall i \in \\{1, 2, \ldots, Q\\},\ s_i = t_i$
- ***subtask2***: $11\\%$ $\forall i \in \\{1, 2, \ldots, Q\\},\ s_i = t_i$
- ***subtask3***: $22\\%$ $N \leq 100 \texttt{ and } Q \leq 100$
- ***subtask4***: $25 \\%$ $\texttt{給定的圖是一棵樹}$
- ***subtask5***: $36 \\%$ ***As statement***